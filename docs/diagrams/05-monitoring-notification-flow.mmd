sequenceDiagram
    participant BackendScheduler as Backend Scheduler<br/>(core/scheduler.py)
    participant MetricsService as MetricsService<br/>(backend/services/metrics.py)
    participant Prometheus as Prometheus<br/>(ë©”íŠ¸ë¦­ ì €ì¥ì†Œ)
    participant NotificationService as NotificationService<br/>(backend/services/notification.py)
    participant Telegram as Telegram Bot API
    participant Grafana as Grafana<br/>(ëŒ€ì‹œë³´ë“œ)

    Note over BackendScheduler: ê±°ë˜ ì‹¤í–‰ ì™„ë£Œ í›„

    par ë³‘ë ¬ ì²˜ë¦¬: ë©”íŠ¸ë¦­ ê¸°ë¡
        BackendScheduler->>MetricsService: record_trade(<br/>symbol,<br/>side,<br/>price,<br/>amount<br/>)
        MetricsService->>MetricsService: trade_counter.labels(<br/>symbol=symbol,<br/>side=side<br/>).inc()
        MetricsService->>MetricsService: trade_amount.labels(<br/>symbol=symbol<br/>).observe(amount)
        MetricsService->>MetricsService: trade_value.labels(<br/>symbol=symbol<br/>).observe(total)
        MetricsService->>Prometheus: Push Metrics<br/>(HTTP /metrics)

        BackendScheduler->>MetricsService: record_ai_decision(<br/>decision,<br/>confidence,<br/>reason<br/>)
        MetricsService->>MetricsService: ai_decision_counter.labels(<br/>decision=decision<br/>).inc()
        MetricsService->>MetricsService: ai_confidence.observe(<br/>confidence<br/>)
        MetricsService->>Prometheus: Push Metrics
    and ë³‘ë ¬ ì²˜ë¦¬: ì•Œë¦¼ ì „ì†¡
        BackendScheduler->>NotificationService: notify_trade(<br/>trade_data<br/>)
        NotificationService->>NotificationService: ë©”ì‹œì§€ í¬ë§·íŒ…

        Note over NotificationService: ğŸ“Š ê±°ë˜ ì•Œë¦¼<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>ğŸ”¹ ì¢…ëª©: KRW-ETH<br/>ğŸ”¹ ê±°ë˜: ë§¤ìˆ˜ âœ…<br/>ğŸ”¹ ê°€ê²©: 3,500,000 KRW<br/>ğŸ”¹ ìˆ˜ëŸ‰: 0.01 ETH<br/>ğŸ”¹ ì´ì•¡: 35,000 KRW<br/>ğŸ”¹ ìˆ˜ìˆ˜ë£Œ: 17.5 KRW<br/>â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”<br/>â° 2024-01-15 10:30:00

        NotificationService->>Telegram: POST /sendMessage
        Telegram-->>NotificationService: Message Sent

        alt ì•Œë¦¼ ì‹¤íŒ¨
            NotificationService->>NotificationService: ì¬ì‹œë„ (ìµœëŒ€ 3íšŒ)
            alt ì¬ì‹œë„ ì‹¤íŒ¨
                NotificationService->>BackendScheduler: Warning Log<br/>(ì•Œë¦¼ ì‹¤íŒ¨)
            end
        end
    end

    Prometheus->>Grafana: Scrape Metrics<br/>(15ì´ˆë§ˆë‹¤)
    Grafana->>Grafana: ëŒ€ì‹œë³´ë“œ ì—…ë°ì´íŠ¸

    Note over Grafana: ì‹¤ì‹œê°„ ì°¨íŠ¸:<br/>- ê±°ë˜ íšŸìˆ˜<br/>- ê±°ë˜ ê¸ˆì•¡<br/>- AI íŒë‹¨ ë¶„í¬<br/>- ì‹ ë¢°ë„ ì¶”ì´



